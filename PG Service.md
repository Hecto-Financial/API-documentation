
# PG Service Standard WEB API

## Content
1. Transaction Collation API (Non-UI)  3
   1. API Description  3
   2. API URI  3
   3. Request and Response Headers  3
   4. Request Parameter (Merchant -> Hecto Financial)  3
   5. Request Parameter Hash Code  4
   6. Response Parameter (Hecto Financial -> Merchant)  4
   7. Transaction Collation Response Value Example  5
   8. Code Table  6
2. Settlement Collation API (Non-UI)  8
   1. API Description  8
   2. API URI  8
   3. Request and Response Headers  8
   4. Request Parameter (Merchant -> Hecto Financial)  8
   5. Request Parameter Hash Code  9
   6. Response Parameter (Hecto Financial -> Merchant)  9
   7. Settlement Collation Response Value Example  10

## 1. Transaction Collation API (Non-UI)

### 1.1 API Description
API for transaction collation inquiry is invoked from merchant server to Hecto Financial server. Hecto Financial’s transaction collation result response is given as the result of the invoke below.

### 1.2 API URI

#### Server Type
| Server   | URL                                                                          | HTTP Method |
|----------|------------------------------------------------------------------------------|-------------|
| Testbed  | https://tb-nspay.settlebank.co.kr/api/pg/{MerchantID}/transInfo.do            | GET/POST    |
| Production | https://nspay.settlebank.co.kr/api/pg/{MerchantID}/transInfo.do             | GET/POST    |

### 1.3 Request and Response Headers
API request and response header formats are as follows.

#### Request
`Content-type=application/x-www-form-urlencoded;charset=UTF-8`

#### Response
`Content-type=text/plain;charset=UTF-8`

### 1.4 Request Parameter (Merchant -> Hecto Financial)
Request column from Merchant server to Hecto Financial are defined as follows.

| Parameter | Name               | Description                              | Type (Length) | Required | Example                             |
|-----------|--------------------|------------------------------------------|---------------|----------|-------------------------------------|
| mchtId    | Merchant ID        | Unique merchant ID given by Hecto Financial | AN(10)        | ●        | "nxca_jt_il"                        |
| mchtTy    | Merchant ID Type   | Merchant ID Type Value                   | AN(1)         | ●        | "M" ※ Fixed Value                  |
| method    | Payment Method     | 2-digit Payment Method Refer to [Payment Method Code] | AN(2) | ●  | "CA"                                |
| pdTy      | Inquiry Period Type | Inquiry Period Type Code                 | AN(1)         | ●        | "D" ※ Fixed Value                  |
| trdDtSt   | Transaction Date   | Transaction Date yyyyMMdd                | N(8)          | ●        | "20211231"                          |
| pktHash   | hash Data          | Hash value generated in SHA256 method Refer to [Request Parameter Hash Code] | AN(200) | ● | "346a2496f3e8b2cbb2ebd157eee0f7404c4e97c34d3cefe8a9b0113cc93f8cc1" |

### 1.5 Request Parameter Hash Code

| Entry   | Combination Field                   |
|---------|-------------------------------------|
| pktHash | Merchant ID + Transaction Date + Authentication Key |

### 1.6 Response Parameter (Hecto Financial -> Merchant)
Response column from Hecto Financial server to Merchant are defined as follows.

#### Inquiry Result - Output first row on inquiry
| Number | Parameter Name   | Description              | Type (Length) |
|--------|------------------|--------------------------|---------------|
| 1      | Result Code      | API response result code | AN(4)         |
| 2      | Result Message   | API response result message | AN(4)      |
| 3      | Number of Inquiries | Number of successful transaction inquiries | N |

#### Transaction History – If Inquiry Success(result:0000) output per transaction from the second row (Repeat)
| Number | Parameter Name                  | Description                                    | Type (Length) |
|--------|---------------------------------|------------------------------------------------|---------------|
| 1      | Merchant ID                     | Merchant ID                                    | AN(10)        |
| 2      | Payment Method                  | Payment method code                            | N(2)          |
| 3      | Hecto Financial Transaction Number | Transaction number generated by Hecto Financial | AN(40)        |
| 4      | Order Number                    | Merchant order number                          | AN(100)       |
| 5      | Approval Type                   | Approve / Cancel Type                          | N(1)          |
| 6      | Transaction Date                | Transaction date (cancellation date) yyyyMMdd  | N(8)          |
| 7      | Transaction Time                | Transaction time (cancellation time) hhmmss    | N(6)          |
| 8      | Transaction Amount              | Transaction amount                             | N(13)         |
| 9      | Original Transaction Number     | Original transaction number for cancelled transaction | AN(40) |
| 10     | Original Transaction Date       | Original transaction date for cancelled transaction | N(8) |
| 11     | Name of Orderer                 | Merchant orderer name                          | AN(88)        |
| 12     | Product Name                    | Merchant product name                          | AN(200)       |
| 13     | Approval Number                 | Credit card approval number                    |               |
| 14     | Financial Company               | Financial company                              | AHN(20)       |
| 15     | Number of Installments          | Number of installments for credit card transaction | N(2) |
| 16     | Interest-Free Installment Status | Merchant-paid interest-free installment transaction status (credit card) | AN(1) |

### 1.7 Transaction Collation Response Value Example

#### Example 1. This is the example of normally processed response value when transaction collation API inquiry is done.

```
0000|NormallyProcessed.|3|
mid_test|VA|STBK_PGVAmid_test000000000000000M0000001|TEST000000000000000001|0|20211231|100001|1000|||HongGilDong|TestProduct||Kbank|||
mid_test|VA|STBK_PGVAmid_test000000000000000M0000002|TEST000000000000000002|0|20211231|100002|2000|||HongGilDong|TestProduct||Kbank|||
mid_test|VA|STBK_PGVAmid_test000000000000000M0000003|TEST000000000000000003|0|20211231|100003|3000|||HongGilDong|||Kbank|||
```

#### Example 2. This is the example of failure response value when transaction collation API inquiry is done.

```
ST92|Hash Value Mismatch.|0|
```

### 1.8 Code Table

#### Collation API Code

| Code | Payment Method           |
|------|--------------------------|
| 0000 | Normally processed.      |
| 1001 | No inquiry details.      |
| ST09 | Invalid request parameter. |
| ST10 | Internal system error.   |
| ST90 | Unregistered merchant ID. |
| ST91 | Require parameter error. |
| ST92 | Hash value mismatch.     |

#### Payment Method Code – Refer to [Payment Method Code]

#### Financial Institution Code – Refer to [Financial Institution Identifier]

#### Card Company Code (Acquirer Code)

| Code | Card Company Name |
|------|-------------------|
| 01   | BC                |
| 02   | Kookmin           |
| 03   | Hana              |
| 04   | Samsung           |
| 05   | Shinhan           |
| 08   | Hyundai           |
| 09   | Lotte             |
| 15   | NH                |

#### Mobile Carrier Code

| Code | Payment Method     |
|------|--------------------|
| SKT  | SK Telecom         |
| KFT  | KT                 |
| LGT  | LG U+              |
| SKL  | SK 7 Mobile        |
| CJH  | CJ Hello Mobile    |
| KCT  | Korea Cable Telecom |

## 2. Settlement Collation API (Non-UI)

### 2.1 API Description
API for settlement collation inquiry is invoked from merchant server to Hecto Financial server. Hecto Financial’s settlement collation result response is given as the result of the invoke below.

### 2.2 API URI

#### Server Type
| Server    | URL                                                                         | HTTP Method |
|-----------|-----------------------------------------------------------------------------|-------------|
| Testbed   | https://tb-nspay.settlebank.co.kr/api/pg/{MerchantID}/sttlmntInfo.do        | GET/POST    |
| Production | https://nspay.settlebank.co.kr/api/pg/{MerchantID}/sttlmntInfo.do          | GET/POST    |

### 2.3 Request and Response Headers
API request and response header formats are as follows.

#### Request
`Content-type=application/x-www-form-urlencoded;charset=UTF-8`

#### Response
`Content-type=text/plain;charset=UTF-8`

### 2.4 Request Parameter (Merchant -> Hecto Financial)
Request column from Merchant server to Hecto Financial are defined as follows.

| Parameter | Name              | Description                                   | Type (Length) | Required | Example                             |
|-----------|-------------------|-----------------------------------------------|---------------|----------|-------------------------------------|
| mchtId   

 | Merchant ID       | Unique merchant ID given by Hecto Financial   | AN(10)        | ●        | "nxca_jt_il"                        |
| method    | Payment Method    | 2-digit Payment Method Refer to [Payment Method Code] | AN(2) | ●  | "CA"                                |
| crtrDt    | Inquiry Date      | Scheduled Date For Settlement yyyyMMdd        | N(8)          | ●        | "20211231"                          |
| pktHash   | hash Data         | Hash value generated in SHA256 method Refer to [Request Parameter Hash Code] | AN(32) | ● | "346a2496f3e8b2cbb2ebd157eee0f7404c4e97c34d3cefe8a9b0113cc93f8cc1" |

### 2.5 Request Parameter Hash Code

| Entry   | Combination Field                  |
|---------|------------------------------------|
| pktHash | Merchant ID + Inquiry Date + Authentication Key |

### 2.6 Response Parameter (Hecto Financial -> Merchant)
Response parameter is the response parameter from Hecto Financial to Merchant with the values of the collation that occurred on the Merchant’s requested transaction date.

#### Inquiry Result - Output first row on inquiry
| Number | Parameter Name    | Description                | Type (Length) |
|--------|-------------------|----------------------------|---------------|
| 1      | Result Code       | API response result code   | AN(4)         |
| 2      | Result Message    | API response result message | AN(4)        |
| 3      | Number of Inquiries | Number of successful transaction inquiries | N |

#### Transaction History – If Inquiry Success(result:0000) output per transaction from the second row (Repeat)
| Number | Parameter Name                | Description                                       | Type (Length) |
|--------|-------------------------------|---------------------------------------------------|---------------|
| 1      | Merchant ID                   | Merchant ID                                       | AN(10)        |
| 2      | Hecto Financial Transaction Number | Transaction number generated by Hecto Financial   | AN(40)        |
| 3      | Original Transaction Number   | Original transaction number of canceled transaction | AN(40) |
| 4      | Payment Method                | Payment method code                               | N(2)          |
| 5      | Approve / Cancel Date         | Transaction date (Cancellation date) yyyyMMdd     | N(8)          |
| 6      | Approve / Cancel Status       | Approve / Cancel classification                   | N(1)          |
| 7      | Financial Company / Carrier Code | Financial Company                                 | AHN(20)       |
| 8      | Approval Number               | Credit card approval number                       |               |
| 9      | Number of Installments        | Number of installments for credit card transaction | N(2)          |
| 10     | Order Number                  | Merchant order number                             | AN(100)       |
| 11     | Name of Orderer               | Merchant orderer name                             | AN(88)        |
| 12     | Product Name                  | Merchant product name                             | AN(200)       |
| 13     | Payment Amount                | Payment amount                                    | N(13)         |
| 14     | Fee                           | Supply amount                                     | N(13)         |
| 15     | Additional Tax                | Additional tax                                    | N(13)         |
| 16     | Expected Settlement Amount    | Expected Settlement Amount                        | N(13)         |
| 17     | Expected Settlement Date      | Expected Settlement Date yyyyMMdd                 | N(8)          |

### 2.7 Settlement Collation Response Value Example

#### Example 1. This is the example of normally processed response value when settlement collation API inquiry is done.

```
0000|Normally Processed.|3|
mid_test|SOFP_00000001|SOFP_00000004|VA|20211231|0|089|||TEST0000001||TestProduct|1000|20|2|978|20210514|
mid_test|SOFP_00000002|SOFP_00000005|VA|20211231|0|089|||TEST0000002||TestProduct|1000|20|2|978|20210514|
mid_test|SOFP_00000003|SOFP_00000006|VA|20211231|0|089|||TEST0000003||TestProduct|1000|20|2|978|20210514|
```

#### Example 2. This is the example of failure response value when settlement collation API inquiry is done.

```
ST92|Hash Value Mismatch.|0|
```

## 3.0 Reference

### 3.1 Payment Method Code
The payment method codes are as follows.

| Code | Payment Method                |
|------|-------------------------------|
| BG   | Book Voucher                  |
| CG   | Culture Land Voucher (Culture Cash) |
| HM   | Happy Money                   |
| TC   | Teen Cash                     |
| CP   | POINTDAMOA                    |
| CA   | Credit Card                   |
| MP   | DCB                           |
| RA   | Wire Transfer                 |
| VA   | Virtual Account               |
| TM   | Tmoney                        |
| SG   | Smart Gift Certificate        |

### 3.2 Financial Institution Identifier
The unique identification codes for financial institutions are as follows.

| Code | Name                          | Code | Name                    |
|------|-------------------------------|------|-------------------------|
| 002  | Korea Development Bank        | 088  | Shinhan Bank            |
| 003  | Industrial Bank               | 089  | Kbank                   |
| 092  | Toss Bank                     | 271  | Toss Securities         |
| 004  | Kookmin Bank                  | 090  | Kakao Bank              |
| 005  | Korea Exchange Bank           | 209  | Yuanta Securities       |
| 007  | NFFC                          | 218  | KB Securities           |
| 011  | NH                            | 238  | Mirae Asset Securities  |
| 012  | NACF                          | 240  | Samsung Securities      |
| 020  | Woori Bank                    | 243  | Korea Investment & Securities |
| 023  | SC Bank                       | 247  | NH Investment & Securities |
| 027  | Korea Citi Bank               | 261  | Kyobo Securities        |
| 031  | Daegu Bank                    | 262  | HI Investment & Securities |
| 032  | Busan Bank                    | 263  | Hyundai Motors Securities |
| 034  | Kwangju Bank                  | 264  | Kiwoom Securities       |
| 035  | Jeju Bank                     | 265  | eBest Securities        |
| 037  | Jeonbuk Bank                  | 266  | SK Securities           |
| 039  | Kyongnam Bank                 | 267  | Daishin Securities      |
| 045  | KFCC                          | 269  | Hanwha Investment & Securities |
| 048  | Credit Union (NCUF)           | 270  | Hana Financial Investment |
| 050  | Mutual Savings Bank           | 278  | Shinhan Financial Investment |
| 054  | HSBC Bank                     | 279  | DB Securities           |
| 055  | Deutsche Bank                 | 280  | Eugene Investment Securities |
| 057  | JP Morgan Chase Bank          | 287  | Meritz Securities       |
| 060  | Bank of America               | 290  | BOOKOOK Securities      |
| 062  | Industrial and Commerical Bank of China | 291 | Shinyoung Securities |
| 064  | National Forestry Cooperatives Federation | 292 | CAPE Investment & Securities |
| 071  | Korea Post                    | 103  | SBI Savings Bank        |
| 081  | KEB Hana Bank                 |      |                         |

